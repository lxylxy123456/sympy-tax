# sympy-tax
Using sympy to compute tax as an equation.

Disclaimer: This project does not provide tax advice. Use at your own risk.

This project is currently only a PoC. Please edit the source code to meet your
needs.

## License

GPL v3

## Usage

Install dependencies: `pip3 install -r requirements.txt`

In `input.yml`, enter your information.

Run the script: `python3 main.py [arguments]`, where arguments are:
* `-f`: change filing status, e.g. single, mfj, hoh, mfs, qss.
* `-c`: override default consts file of `consts/2024.yml`.
* `-i`: override default input file of `input.yml`.
* `--plot`: Plot some kind of tax rate graph.

Example: `python3 main.py -f mfj -c my_input.yml`

## Demo

Run the program using some example input generated by ChatGPT:

```
$ cat > input.yml

# Generated using ChatGPT
v_f1040_1a: 120000
v_f1040_25a: 20000
v_ca540_12: 120000
v_ca540_71: 6000
v_f1040sb_2: 1500
v_f1040_3a: 4000
v_f1040sb_6: 3000
v_f1040sd_1a_d: 5000
v_f1040sd_1a_e: 5
v_f1040sd_8a_d: 10000
v_f1040sd_8a_e: 10

$ python3 main.py -f single
v_f1040_1z = 120000
v_f1040sb_4 = 1500
v_f1040_2b = 1500
v_f1040_3b = 3000
v_f1040sd_1a_h = 4995
v_f1040sd_1b_h = 0
v_f1040sd_2_h = 0
v_f1040sd_3_h = 0
v_f1040sd_7 = 4995
v_f1040sd_8a_h = 9990
v_f1040sd_8b_h = 0
v_f1040sd_9_h = 0
v_f1040sd_10_h = 0
v_f1040sd_15 = 9990
v_f1040sd_16 = 14985
v_f1040sd_17 = 1
v_f1040sd_20 = 1
v_f1040sd_21 = undefined
v_f1040sd_22 = undefined
v_f1040_7 = 14985
v_f1040_9 = 139485
v_f1040_11 = 139485
v_f1040_12 = 14600
v_f1040_14 = 14600
v_f1040_15 = 124885
v_f1040_16_qdcgtw_1 = 124885
v_f1040_16_qdcgtw_2 = 4000
v_f1040_16_qdcgtw_3 = 14985
v_f1040_16_qdcgtw_4 = 18985
v_f1040_16_qdcgtw_5 = 105900
v_f1040_16_qdcgtw_6 = 47025
v_f1040_16_qdcgtw_7 = 47025
v_f1040_16_qdcgtw_8 = 47025
v_f1040_16_qdcgtw_9 = 0
v_f1040_16_qdcgtw_10 = 18985
v_f1040_16_qdcgtw_11 = 0
v_f1040_16_qdcgtw_12 = 18985
v_f1040_16_qdcgtw_13 = 518900
v_f1040_16_qdcgtw_14 = 124885
v_f1040_16_qdcgtw_15 = 105900
v_f1040_16_qdcgtw_16 = 18985
v_f1040_16_qdcgtw_17 = 18985
v_f1040_16_qdcgtw_18 = 2847.75000000000
v_f1040_16_qdcgtw_19 = 18985
v_f1040_16_qdcgtw_20 = 0
v_f1040_16_qdcgtw_21 = 0
v_f1040_16_qdcgtw_22 = 18458.5000000000
v_f1040_16_qdcgtw_23 = 21306.2500000000
v_f1040_16_qdcgtw_24 = 23014.9000000000
v_f1040_16_qdcgtw_25 = 21306.2500000000
v_f1040_16 = 21306.2500000000
v_f1040_18 = 21306.2500000000
v_f1040_21 = 0
v_f1040_24 = 21306.2500000000
v_f1040_25d = 20000
v_f1040_32 = 0
v_f1040_33 = 20000
v_f1040_34 = undefined
v_f1040_37 = 1306.25000000000
v_ca540_7_n = 1
v_ca540_7 = 149
v_ca540_8 = 0
v_ca540_9 = 0
v_ca540_10 = 0
v_ca540_11 = 149
v_ca540_13 = 139485
v_ca540ca_I_A_1a_A = 120000
v_ca540ca_I_A_1b_A = 0
v_ca540ca_I_A_1c_A = 0
v_ca540ca_I_A_1d_A = 0
v_ca540ca_I_A_1e_A = 0
v_ca540ca_I_A_1f_A = 0
v_ca540ca_I_A_1g_A = 0
v_ca540ca_I_A_1h_A = 0
v_ca540ca_I_A_1z_A = 120000
v_ca540ca_I_A_1z_B = 0
v_ca540ca_I_A_1z_C = 0
v_ca540ca_I_A_2a_A = 0
v_ca540ca_I_A_2b_A = 1500
v_ca540ca_I_A_3a_A = 4000
v_ca540ca_I_A_3b_A = 3000
v_ca540ca_I_A_4a_A = 0
v_ca540ca_I_A_4b_A = 0
v_ca540ca_I_A_5a_A = 0
v_ca540ca_I_A_5b_A = 0
v_ca540ca_I_A_6a_A = 0
v_ca540ca_I_A_6b_A = 0
v_ca540ca_I_A_7_A = 14985
v_ca540ca_I_B_10_A = 139485
v_ca540ca_I_B_10_B = 0
v_ca540ca_I_B_10_C = 0
v_ca540ca_I_C_26_A = 0
v_ca540ca_I_C_26_B = 0
v_ca540ca_I_C_26_C = 0
v_ca540ca_I_C_27_A = 139485
v_ca540ca_I_C_27_B = 0
v_ca540ca_I_C_27_C = 0
v_ca540ca_II_22 = 0
v_ca540ca_II_23 = 139485
v_ca540ca_II_24 = 2789.70000000000
v_ca540ca_II_25 = 0
v_ca540ca_II_26 = 0
v_ca540ca_II_28 = 0
v_ca540ca_II_29 = 0
v_ca540ca_II_30 = 5540
v_ca540_14 = 0
v_ca540_15 = 139485
v_ca540_16 = 0
v_ca540_17 = 139485
v_ca540_18 = 5540
v_ca540_19 = 133945
v_ca540_31 = 8999.24700000000
v_ca540_32 = 149
v_ca540_33 = 8850.24700000000
v_ca540_35 = 8850.24700000000
v_ca540_47 = 0
v_ca540_48 = 8850.24700000000
v_ca540_64 = 8850.24700000000
v_ca540_78 = 6000
v_ca540_93 = 6000
v_ca540_94 = undefined
v_ca540_95 = 6000
v_ca540_96 = undefined
v_ca540_97 = undefined
v_ca540_99 = undefined
v_ca540_100 = 2850.24700000000
v_ca540_111 = undefined
v_ca540_114 = undefined
v_ca540_115 = undefined
$ 
```

Print all results as a function to `v_f1040_1a` and plot the tax rate graph:

```
$ python3 main.py -f single --variable-inputs v_f1040_1a -v --plot
v_f1040_1z = v_f1040_1a
           = 120000

v_f1040sb_4 = 1500
            = 1500
...

v_f1040_15 = Max(0, v_f1040_1a + 4885)
           = 124885

v_f1040_16_qdcgtw_1 = Max(0, v_f1040_1a + 4885)
                    = 124885
...

v_f1040_37 = Max(0, Min(Piecewise((0.22*Max(0, Max(0, v_f1040_1a + 4885) ... (1972)
             if (Max(0, v_f1040_1a + 4885) >= 100000) & (Max(0, Max(0, v_f10... (2070)
           = 1306.25000000000
...

v_ca540_100 = Max(0, Piecewise((0.01*Max(0, v_f1040_1a + 13945), Max(0, v_... (730)
              if (v_f1040_1a + 19485 <= 244857) & (6000 < Max(0, Piecewise((0... (765)
            = 2850.24700000000
...

$ 
```

![demo.png](misc/demo.png)

